{% extends 'base.html' %}
{% load static %}
{% block title %}Interactive Periodic Table - GeNiUS Ed Tech{% endblock %}

{% block extra_css %}
<style>
    /* Periodic Table Specific Styling */
    .periodic-table {
        display: grid;
        grid-template-columns: repeat(18, 1fr);
        gap: 3px;
        margin-bottom: 20px;
        grid-template-rows: repeat(7, auto) 10px repeat(2, auto);
    }
    
    .element {
        aspect-ratio: 1;
        border: 1px solid rgba(255,255,255,0.1);
        padding: 4px;
        cursor: pointer;
        transition: all 0.2s;
        text-align: center;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        border-radius: 8px;
        background: var(--bg-card);
        backdrop-filter: blur(10px);
    }
    
    .element:hover {
        transform: scale(1.1);
        z-index: 1;
        box-shadow: 0 0 20px rgba(0, 184, 148, 0.3);
        border-color: var(--u-green);
    }
    
    .atomic-number { 
        font-size: 11px;
        align-self: flex-start;
        color: var(--text-secondary);
    }
    
    .symbol { 
        font-size: 16px; 
        font-weight: bold;
        margin: 2px 0;
        color: var(--text-primary);
    }
    
    .name { 
        font-size: 9px;
        margin-bottom: 2px;
        overflow: hidden;
        text-overflow: ellipsis;
        color: var(--text-secondary);
    }
    
    .mass { 
        font-size: 9px;
        color: var(--text-muted);
    }
    
    /* Element Categories */
    .alkali-metal { 
        background: rgba(255, 205, 210, 0.2); 
        color: #ffcdd2;
    }
    .alkaline-earth { 
        background: rgba(255, 224, 178, 0.2);
        color: #ffe0b2;
    }
    .transition-metal { 
        background: rgba(255, 249, 196, 0.2);
        color: #fff9c4;
    }
    .post-transition { 
        background: rgba(200, 230, 201, 0.2);
        color: #c8e6c9;
    }
    .metalloid { 
        background: rgba(178, 223, 219, 0.2);
        color: #b2dfdb;
    }
    .nonmetal { 
        background: rgba(187, 222, 251, 0.2);
        color: #bbdefb;
    }
    .noble-gas { 
        background: rgba(225, 190, 231, 0.2);
        color: #e1bee7;
    }
    .lanthanide { 
        background: rgba(248, 187, 208, 0.2);
        color: #f8bbd0;
    }
    .actinide { 
        background: rgba(255, 204, 188, 0.2);
        color: #ffccbc;
    }

    .legend {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 12px;
        margin: 20px auto;
        padding: 20px;
        background: var(--bg-card);
        backdrop-filter: blur(10px);
        border-radius: 16px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        max-width: 1000px;
    }

    .legend-item {
        display: flex;
        align-items: center;
        padding: 12px 16px;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
        background: rgba(26, 31, 58, 0.5);
        border: 1px solid rgba(255,255,255,0.05);
        position: relative;
        overflow: hidden;
    }

    .legend-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 184, 148, 0.2);
    }

    .legend-color {
        width: 24px;
        height: 24px;
        border-radius: 6px;
        margin-right: 12px;
        position: relative;
    }

    .legend-text {
        display: flex;
        flex-direction: column;
        flex-grow: 1;
    }

    .legend-title {
        font-weight: 600;
        font-size: 14px;
        color: var(--text-primary);
        margin-bottom: 2px;
    }

    .legend-count {
        font-size: 12px;
        color: var(--text-secondary);
    }

    /* Quiz Modal */
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.7);
        z-index: 1000;
    }

    .modal-content {
        background: var(--bg-card);
        backdrop-filter: blur(20px);
        margin: 5% auto;
        padding: 25px;
        width: 90%;
        max-width: 600px;
        border-radius: 20px;
        position: relative;
        max-height: 90vh;
        overflow-y: auto;
        text-align: center;
        border: 2px solid transparent;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .modal-content::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        border-radius: 20px;
        padding: 2px;
        background: var(--primary-gradient);
        mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        mask-composite: exclude;
        z-index: -1;
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .modal-content:hover::before {
        opacity: 1;
    }

    .close {
        position: absolute;
        right: 15px;
        top: 10px;
        cursor: pointer;
        font-size: 24px;
        color: var(--text-muted);
        line-height: 1;
    }

    .close:hover {
        color: var(--text-primary);
    }

    /* Quiz Elements */
    .quiz-button {
        background: var(--primary-gradient);
        color: var(--bg-primary);
        border: none;
        border-radius: 25px;
        padding: 12px 25px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(0, 184, 148, 0.3);
    }

    .quiz-button:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 30px rgba(0, 184, 148, 0.4);
    }

    .quiz-option {
        background: var(--bg-secondary);
        border: 1px solid rgba(255,255,255,0.1);
        color: var(--text-secondary);
        transition: all 0.3s ease;
    }

    .quiz-option:hover {
        background: rgba(0, 184, 148, 0.1);
        border-color: var(--u-green);
    }

    .quiz-option.correct {
        background: rgba(0, 184, 148, 0.2);
        border-color: var(--u-green);
        color: var(--u-green);
    }

    .quiz-option.incorrect {
        background: rgba(225, 112, 85, 0.2);
        border-color: var(--er-pink);
        color: var(--er-pink);
    }

    /* Responsive adjustments */
    @media (max-width: 1200px) {
        .periodic-table {
            grid-template-columns: repeat(18, 1fr);
            font-size: 90%;
            gap: 2px;
        }
    }

    @media (max-width: 768px) {
        .periodic-table {
            grid-template-columns: repeat(18, 1fr);
            gap: 1px;
        }
        
        .element {
            font-size: 11px;
            padding: 2px;
        }
        
        .atomic-number {
            font-size: 9px;
        }
        
        .symbol {
            font-size: 14px;
        }
        
        .name, .mass {
            font-size: 8px;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="text-center mb-5 fade-in">
        <h1 class="text-gradient mb-3">
            <i class="fas fa-atom"></i> Interactive Periodic Table
        </h1>
        <p style="color: var(--text-secondary);">Explore chemical elements and test your knowledge</p>
    
        <div class="controls mt-4">
            <input type="text" class="form-control mb-3" placeholder="Search elements..." id="searchInput">
            <button class="btn btn-primary" onclick="startQuiz()">
                <i class="fas fa-question-circle me-2"></i>Take Quiz
            </button>
        </div>
    </div>
    
    <div class="legend">
        <div class="legend-item alkali-metal" data-category="alkali-metal">
            <div class="legend-color" style="background: #ffcdd2"></div>
            <div class="legend-text">
                <span class="legend-title">Alkali Metals</span>
                <span class="legend-count">6 elements</span>
            </div>
        </div>
        <div class="legend-item alkaline-earth" data-category="alkaline-earth">
            <div class="legend-color" style="background: #ffe0b2"></div>
            <div class="legend-text">
                <span class="legend-title">Alkaline Earth Metals</span>
                <span class="legend-count">6 elements</span>
            </div>
        </div>
        <div class="legend-item transition-metal" data-category="transition-metal">
            <div class="legend-color" style="background: #fff9c4"></div>
            <div class="legend-text">
                <span class="legend-title">Transition Metals</span>
                <span class="legend-count">38 elements</span>
            </div>
        </div>
        <div class="legend-item post-transition" data-category="post-transition">
            <div class="legend-color" style="background: #c8e6c9"></div>
            <div class="legend-text">
                <span class="legend-title">Post-transition Metals</span>
                <span class="legend-count">8 elements</span>
            </div>
        </div>
        <div class="legend-item metalloid" data-category="metalloid">
            <div class="legend-color" style="background: #b2dfdb"></div>
            <div class="legend-text">
                <span class="legend-title">Metalloids</span>
                <span class="legend-count">7 elements</span>
            </div>
        </div>
        <div class="legend-item nonmetal" data-category="nonmetal">
            <div class="legend-color" style="background: #bbdefb"></div>
            <div class="legend-text">
                <span class="legend-title">Nonmetals</span>
                <span class="legend-count">7 elements</span>
            </div>
        </div>
        <div class="legend-item noble-gas" data-category="noble-gas">
            <div class="legend-color" style="background: #e1bee7"></div>
            <div class="legend-text">
                <span class="legend-title">Noble Gases</span>
                <span class="legend-count">7 elements</span>
            </div>
        </div>
        <div class="legend-item lanthanide" data-category="lanthanide">
            <div class="legend-color" style="background: #f8bbd0"></div>
            <div class="legend-text">
                <span class="legend-title">Lanthanides</span>
                <span class="legend-count">15 elements</span>
            </div>
        </div>
        <div class="legend-item actinide" data-category="actinide">
            <div class="legend-color" style="background: #ffccbc"></div>
            <div class="legend-text">
                <span class="legend-title">Actinides</span>
                <span class="legend-count">15 elements</span>
            </div>
        </div>
    </div>
    
    <div class="periodic-table" id="periodicTable"></div>

    <div id="elementModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="elementDetails"></div>
        </div>
    </div>

    <div id="quizModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="quizContainer">
                <h2>Periodic Table Quiz</h2>
                <div id="quizScore"></div>
                <div id="quizQuestion"></div>
                <div id="quizOptions"></div>
                <div id="quizFeedback"></div>
                <button class="btn btn-primary mt-3" id="nextButton" style="display: none;">Next Question</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Complete periodic table data with all 118 elements
const elements = [
    {number: 1, symbol: "H", name: "Hydrogen", mass: "1.008", category: "nonmetal", period: 1, group: 1},
    {number: 2, symbol: "He", name: "Helium", mass: "4.003", category: "noble-gas", period: 1, group: 18},
    // ... all other elements ...
];

// Quiz questions - same as in the provided code
const quizQuestions = [
    {
        question: "Which element has the highest atomic number?",
        options: ["Uranium", "Oganesson", "Plutonium", "Fermium"],
        correct: "Oganesson",
        explanation: "Oganesson (Og) has an atomic number of 118, making it the element with the highest atomic number.",
        difficulty: "medium"
    },
    // ... other quiz questions ...
];

// Initialize variables
let currentQuestion = 0;
let score = 0;
let questionAnswered = false;

// Functions for periodic table - same as in the provided code
function createPeriodicTable() {
    // ... code to create periodic table ...
}

function getElectronConfig(atomicNumber) {
    // ... code to get electron configuration ...
}

function toSuperscript(num) {
    // ... code for superscript conversion ...
}

function showElementDetails(element) {
    // ... code to show element details ...
}

function startQuiz() {
    // ... quiz code ...
}

function showQuestion() {
    // ... quiz code ...
}

function checkAnswer(selected) {
    // ... quiz code ...
}

// Event listeners and initialization
document.addEventListener('DOMContentLoaded', function() {
    createPeriodicTable();
    
    // Search functionality
    document.getElementById('searchInput').addEventListener('input', function(e) {
        // ... search code ...
    });

    // Legend interactivity
    const legendItems = document.querySelectorAll('.legend-item');
    legendItems.forEach(item => {
        item.addEventListener('click', function() {
            // ... legend code ...
        });
    });

    // Close modals
    document.querySelectorAll('.close').forEach(button => {
        button.onclick = function() {
            this.closest('.modal').style.display = 'none';
        }
    });

    window.onclick = function(event) {
        if (event.target.classList.contains('modal')) {
            event.target.style.display = 'none';
        }
    }
});

function resetDisplay() {
    // ... reset display code ...
}
</script>
{% endblock %}
